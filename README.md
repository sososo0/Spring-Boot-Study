# Spring Boot 

Spring Framework는 Java 기반의 애플리케이션 프레임워크로 엔터프라이즈급 애플리케이션을 개발하기 위한 다양한 기능을 제공한다. Spring은 목적에 따라 다양한 프로젝트를 제공하는데, 그중 하나가 **Spring Boot**이다. 

## Spring Framework 

스프링 프레임워크는 자바에서 가장 많이 사용하는 프레임워크 
- 현재 우리나라의 전자정부 표준 프레임워크의 기반 기술로 채택되어 공공기간 웹 서비스를 개발할 때도 사용 
- 스프링은 자바 언어를 이용해 엔터프라이즈급 개발을 편리하게 만들어주는 '오픈소스 경량급 애플리케이션 프레임워크'로 불린다. 
- 쉽게 말하면 자바로 애플리케이션을 개발하는 데 필요한 기능을 제공하고 쉽게 사용하도록 도와주는 도구이다. 

> 엔터프라이즈급 개발 
> 
> 기업 환경을 대상으로 하는 개발. 네이버, 카카오톡 같은 대규모 데이터를 처리하는 환경을 엔터프라이즈 환경이라고 함. 
> 스프링은 이 환경에 알맞게 설계돼 있어 개발자는 애플리케이션을 개발할 때 많은 요소를 프레임워크에 위임하고 비즈니스 로직을 구현하는 데 집중할 수 있음. 

스프링의 핵심 가치 : 애플리케이션 개발에 필요한 기반을 제공해서 개발자가 비즈니스 로직 구현에만 집중할 수 있게끔 하는 것 

### 제어 역전(IoC) - Spring

자바 개발에서 객체를 사용하기 위해 사용하려는 객체를 선언하고 해당 객체의 의존성을 생성한 후 객체에서 제공하는 기능을 사용 
- 객체를 생성하고 사용하는 일련의 작업을 개발자가 직접 제어하는 구조 

하지만, 제어 역전을 특징으로 하는 스프리은 기존 자바 개발 방식과 다르게 동작 
- IoC를 적용한 환경에서는 사용할 객체를 직접 생성하지 않고 객체의 생명주기 관리를 외부에 위임함 
  - 여기서 외부는 스프링 컨테이너 혹은 IoC 컨테이너
- 이렇게 객체의 관리를 컨테이너에 맡겨 제어권이 넘어간 것이 제어 역전 
  - 제어 역전을 통해 의존성 주입, 관점 지향 프로그래밍 등이 가능 
  - 객체의 제어권을 컨테이너로 넘기기 때문에 개발자는 비즈니스 로직을 작성하는 데 더 집중 가능

### 의존성 주입(DI) - Spring

의존성 주입은 제어 역전 방법 중 하나로 사용할 객체를 직접 생성하지 않고 외부 컨테이너가 생성한 객체를 주입받아 사용하는 방식 

의존성 주입받는 방법 3가지 
- 생성자를 통한 의존성 주입 
- 필드 객체 선언을 통한 의존성 주입 
- setter 메서드를 통한 의존성 주입 

> 스프링에서는 @Autowired라는 어노테이션(annotation)을 통해 의존성을 주입할 수 있음 
> - 스프링 4.3 이후 버전은 생성자를 통해 의존성을 주입할 때 @Autowired 어노테이션을 생략 가능 
> - 스프링을 처음 다룰 때는 가독성을 위해 어노테이션 명시하는 것을 권장 

~~~
@RestController 
public class DIController {
    MyService myService;
    
    @Autowired 
    public DIController(MyService myService) {
        this.myService = myService;
    }
    
    @GetMapping("/di/hello") 
    public String getHello() {
        return myService.getHello(); 
    }
}
~~~
- 생성자를 통한 의존성 주입 

~~~
@RestController 
public class DIController {
    @Autowired 
    private MyService myService;
}
~~~
- 필드 객체 선언을 통한 의존성 주입 

~~~
@RestController 
public class DIController {
    MyService myService;
    
    @Autowired 
    public void seyMyService(MyService myService) {
        this.myService = myService;
    }
}
~~~
- setter 메서드를 통한 의존성 주입 

> 스프링 공식 문서에서 권장하는 의존성 주입 방법은 생성자를 통한 의존성 주입 방식 
> - 다른 방식과는 달리 생성자를 통해 의존성을 주입받는 방식을 레퍼런스 객체 없이는 객체를 초기화할 수 없게 설계할 수 있기 때문 

### 관점 지향 프로그래밍 (AOP) - Spring

관점 지향 프로그래밍은 스프링의 아주 중요한 특징 
- OOP로 오해하는 경우가 종종 있다. AOP는 OOP를 더욱 잘 사용하도록 돕는 개념으로 생각하는 것이 좋다. 

<br>

관점을 기준으로 묶어 개발하는 방식 
- 여기서 관점(aspect)이란 어떤 기능을 구현할 때 그 기능을 핵심 기능과 부가 기능으로 구분해 각각을 하나의 관점으로 보는 것을 의미 

<br>

핵심 기능 
- 비즈니스 로직을 구현하는 과정에서 비즈니스 로직이 처리하려는 목적 기능 
- 클라이언트로부터 상품 정보 등록 요청을 받아 데이터베이스에 저장하고, 그 상품 정보를 조회하는 비즈니스 로직을 구현 
  - 상품 정보를 데이터베이스에 저장, 저장된 상품 정보 데이터를 보여주기 2가지 코드가 핵심 기능

<br>

실제 애플리케이션을 개발할 때는 핵심 기능에 부가 기능을 추가할 상황이 생긴다. 
- 핵심 기능인 비즈니스 로직 사이에 로깅 처리를 하거나 트랜잭션 처리를 하는 코드를 예로 들 수 있다. 

<br>

OOP 방식의 애플리케이션 로직에서는 객체마다 핵심 기능을 수행하기 위한 로직과 함께 부가 기능인 로깅, 트랜잭션 등의 코드 작성 
- 상품 정보 등록 기능과 상품 정보 조회 기능은 엄연히 다른 기능이지만 유지보수 목적이나 데이터베이스 접근을 위해 작성된 로깅과 트랜잭션 영역은 동일한 기능을 수행할 확률이 높다. 
- 이는 핵심 기능을 구현한 두 로직에 동일한 코드가 포함된다는 것을 의미 

<br>

AOP 관점에서는 부가 기능은 핵심 기능이 어떤 기능인지 무관하게 로직이 수행되기 전 또는 후에 수행되기만 하면 된다. 
- 이렇게 여러 비즈니스 로직에서 반복되는 부가 기능을 하나의 공통 로직으로 처리하도록 모듈화에 삽입하는 방식이 AOP

#### AOP를 구현하는 3가지 방법 

1. 컴파일 과정에 삽입 
2. 바이트코드를 메모리에 로드하는 과정에 삽입 
3. Proxy 패턴을 이용 

이 중 스프링은 Proxy 패턴을 통해 AOP 기능을 제공 

> 스프링 AOP의 목적은 OOP와 마찬가지로 모듈화해서 재사용 가능한 구성을 만드는 것, 모듈화된 객체를 편하게 적용할 수 있게 함으로써 개발자가 비즈니스 로직을 구현하는 데만 집중할 수 있게 도와줌 

## 스프링 vs 스프링부트 

스프링 프레임워크는 기존 개발 방식의 문제와 한계를 극복하기 위해 다양한 기능을 제공 
- 하지만, 기능이 많은 만큼 설정이 복잡 
- 이렇게 필요한 모듈을 추가하다 보면 설정이 복잡해지는 문제를 해결하기 위해 등장한 것 스프링 부트 

> 스프링 부트를 이용하면 단독으로 실행 가능한 상용 수준의 스프링 기반 애플리케이션을 손쉽게 만들 수 있다. 
> - 이는 복잡한 설정을 하지 않아도 스프링 부트를 사용하면 개발이 쉬워진다는 의미 

### 의존성 관리 - SpringBoot 

스프링 프레임워크에서는 개발에 필요한 각 모듈의 의존성을 직접 설정해야 하고 호환되는 버전을 명시해야 정상 작동한다. 
- 애플리케이션에서 사용하는 스프링 프레임워크나 라이브러리 버전을 올리는 상황에서는 다른 라이브러리의 버전까지도 고려해야 함 

하지만, 스프링부트에서는 이 같은 불편함을 해소하고자 spring-boot-starter라는 의존성을 제공한다.
- spring-boot-starter의 의존성은 여러 종류, 각 라이브러리의 기능과 관련해서 자주 사용되고 서로 호환되는 버전의 모듈 조합을 제공 
- 이를 통해 개발자는 라이브러리 호환 문제를 해결할 수 있다. 

#### 많이 사용되는 spring-boot-starter 라이브러리 

- spring-boot-starter-web : 스프링 MVC를 사용하는 RESTful 애플리케이션을 만들기 위한 의존성, 기본으로 내장 톰캣(Tomcat)이 포함되어 있어 jar 형식으로 실행 가능 
- spring-boot-starter-test : JUnit Jupiter, Mockito 등의 테스트용 라이브러리 포함 
- spring-boot-starter-jdbc : HikariCP 커넥션 풀을 활용한 JDBC 기능 제공
- spring-boot-starter-security : 스프링 시큐리티(인증, 권한, 인가 등) 기능 제공 
- spring-boot-starter-data-jpa : 하이버네이트를 활용한 JPA 기능 제공 
- spring-boot-starter-cache : 스프링 프레임워크의 캐시 기능 지원 

> Tip : spring-boot-starter의 여러 라이브러리를 함께 사용할 때는 의존성이 겹칠 수 있다. 이로 인해 버전 충돌이 발생할 수 있는데, 의존성 조합 충돌 문제가 없도록 spring-boot-starter-parent가 검증된 조합을 제공 

### 자동 설정 - SpringBoot 

스프링 부트는 스프링 프레임워크의 기능을 사용하기 위한 자동 설정을 지원. 
- 자동 설정은 애플리케이션에 추가된 라이브러리를 실행하는 데 필요한 환경 설정을 알아서 찾아준다. 
- 애플리케이션을 개발하는 데 필요한 의존성을 추가하면 프레임워크가 이를 자동으로 관리해준다. 

~~~
@SpringBootApplication
public class SpringBootApplication {
    public static void main(String[] args) {
        SpringBootApplication.run(SpringBootApplication.class, args);
    }
}
~~~
- 스프링 부트의 메인 애플리케이션 코드로 스프링 부트 프로젝트를 생성하면 볼 수 있다. 
- 여기서 볼 것은 @SpringBootApplication 어노테이션이다. 
  - 여러 어노테이션을 합쳐 놓은 인터페이스지만 기능 위주로 보면 크게 3가지 어노테이션을 합쳐놓은 구성 
  - @SpringBootConfiguration 
  - @EnableAutoConfiguration 
  - @ComponentScan

#### 스프링 부트 애플리케이션이 실행되면..

1. @ComponentScan 어노테이션이 @Component 시리즈 어노테이션이 붙은 클래스를 발견해 Bean을 등록 
2. 이후 @EnableAutoConfiguration 어노테이션을 통해 spring-boot-autoconfigure 패키지 안에 spring.factories 파일을 추가해 다양한 자동 설정이 일부 조건을 거쳐 적용 
    - spring.factories 파일에는 다양한 autoconfigure 항목이 존재 
    - 이 항목들은 각 파일에 설정된 @Conditional 조건을 충족할 경우 Bean에 등록되고 애플리케이션에 자동으로 반영

> @Component 시리즈 어노테이션에서 '시리즈'는 @Component 어노테이션이 포괄하는 어노테이션들을 통합하기 위해 사용한 표현, 이러한 @Component 시리즈 어노테이션의 대표적인 예는 다음과 같다. 
> - @Controller 
> - @RestController 
> - @Service 
> - @Repository 
> - @Configuration 

### 내장 WAS - SpringBoot 

스프링 부트의 각 웹 애플리케이션에는 내장 WAS(Web Application Server)가 존재 
- 웹 애플리케이션을 개발할 때 가장 기본이 되는 의존성인 spring-boot-starter-web의 경우 톰캣을 내장한다. 
- 스프링 부트의 자동 설정 기능은 톰캣에도 적용, 특별한 설정 없이도 톰캣을 실행 가능 
- 필요에 따라 톰캣이 아닌 다른 웹 서버로 대체 가능 

### 모니터링 - SpringBoot 

개발이 끝나고 서비스를 운영하는 시기에는 해당 시스템이 사용하는 스레드, 메모리, 세션 등의 주요 요소들을 모니터링해야 함 
- 스프링 부트에는 스프링 부트 액추에이터(Spring Boot Actuator)라는 자체 모니터링 도구가 있다. 

<br>

> [스프링 부트 핵심 가이드 - 스프링 부트를 활용한 애플리케이션 개발 실무]를 참고하였습니다.
> [스프링 입문 - 코드로 배우는 스프링 부트, 웹 MVC, DB 접근 기술]을 참고하였습니다.
> [토비의 스프링 부트 - 이해와 원리]를 참고하였습니다.
